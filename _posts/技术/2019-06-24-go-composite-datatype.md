---
layout: post
title: Go 语言圣经学习笔记-复合数据类型
category: 技术
---


## 4.2 Slice

slice 表示一个拥有相同类型元素的可变长度的序列。slice是和数组紧密关联的，slice是一种轻量的数据结构，可以用来访问数组的部分或者全部的元素，而这个数组称为slice的底层数组。
slice有三个属性：指针、长度和容量。指针指向数组第一个可以从slice中访问的元素，而这个元素不一定是数组的第一个元素，长度是指slice中元素的个数,它不能超过slice的容量。容量的大小一般是底层数组的大小。Go的内置函数len和cap可以返回slice的长度和容量。

如果slice的引用超过被引用对象的容量，就会Panic，但是如果只是超出了被引用对象的长度，即len(s)，那么最终slice会比原slice长。

因为slice包含指向数组元素的指针，所以将slice传递给函数的是和，可以在函数内部修改底层数组的的元素。
注意slice的初始化表达式和数组的区别。slice没有指定长度，这种隐式的区别是创建有固定长度的数组和创建指向数组长度的slice。

和数组不同的是,slice不能做比较，因此不能通过==来测试两个slice是否相同。这里有两个原因：
首先，slice的元素是非直接的，有可能slice可以包含自身，虽然可以处理这种特殊情况，但是没有一种是简单、高效、直观的。
其次，因为元素不是直接的，如果底层数组改变，同一slice在不同的时间，会拥有不同的元素。由于散列表（例如map）仅对元素的键做浅拷贝，这就要求散列表的键在整个生命周期内保持不变。因为slice需要深度比较，所以不能用作Map的键。所以最安全的方法就是不允许直接比较slice。
slice唯一允许的比较是和nil做比较，但是也有非nil的slice长度和容量是0的，所以如果检查一个slice是否为空，建议使用len(s) == 0，而不是s == nil。
make可以创建一个具有指定元素类型、长度和容量的slice.

```go
make([]T,len)
make([]T,len,cap)
```

### 4.2.1 append函数

内置的append用来将元素追加到slice的后面。